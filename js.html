<script>
//boton subir
  window.addEventListener("scroll", function() 
  {
    if(this.window.scrollY > 500)
    {
      document.getElementById("botonsubir").style.transform = "scale(1)";      
    }
    if(this.window.scrollY < 500)
    {
      document.getElementById("botonsubir").style.transform = "scale(0)";      
    }
  });

function subirArriba()
{
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}

function limpiar()
{
  eliminarTabla();
  eliminarTarjeta();
  crearLoader('divContactos');
}

  function insertarContacto()
{      
  limpiar();
  
  //Obtner Datos
  let nombre = document.getElementById('nombre').value;
  let canton = document.getElementById('canton').value;
  let correo = document.getElementById('correo').value;
  let telf = document.getElementById('telf').value;

  //Cerrar Modal
 bootstrap.Modal.getInstance(document.getElementById('crearContactoModal')).hide();
    google.script.run
    .withSuccessHandler(contactoInsertadoCorrectamente)
    .withFailureHandler(contactoinsertadoError)
    .insertarContacto(nombre, canton, correo, telf);       
}

function contactoInsertadoCorrectamente()
{
  //Eliminamos los datos de los input
  document.getElementById('nombre').value='';
  document.getElementById('correo').value='';

  //mostrar notificación
  crearNotificacionOk('Contacto insertado correctamente', 'AGREGAR CONTACTO');

  //Eliminar loader
  eliminarLoader();

  //Mostramos la Tabla
  crearTablaContactos();
}

function contactoinsertadoError()
{
  crearNotificacionError('No se ha podido insertar el contacto', 'ERROR');
  //Eliminar loader
  eliminarLoader();

  //Mostramos la Tabla
  crearTablaContactos();
}


function modificarContacto(numFila) 
{
   //Cerrar Modal
    bootstrap.Modal.getOrCreateInstance(document.getElementById('crearContactoModal')).hide();
    //Obtener nuevos datos a partir del formulario
    let nombre = document.getElementById('nombre').value;
    let canton = document.getElementById('canton').value;
    let correo = document.getElementById('correo').value;
    let telf = document.getElementById('telf').value;

    limpiar();

    google.script.run
        .withSuccessHandler(contactoModificadoCorrectamente)
        .withFailureHandler(contactoModificadoError)
        .modificarContacto(numFila, {nombre, canton, correo, telf});
}

function contactoModificadoCorrectamente() 
{
//mostrar notificación
  crearNotificacionContacto('Contacto modificado correctamente', 'MODIFICADO OK');
  //Eliminar loader
  eliminarLoader();
  //Mostramos la Tabla
  crearTablaContactos();

}

function contactoModificadoError()
{
    //mostrar notificación
  crearNotificacionError('Problemas al Modificar', 'ERROR');
  //Eliminar loader
  eliminarLoader();
  //Mostramos la Tabla
  crearTablaContactos();

}


function borrarContacto(numFila) 
{
  limpiar();

    google.script.run
    .withSuccessHandler(contactoBorradoCorrectamente)
    .withFailureHandler(contactoborradoError)
    .borrarContacto(numFila);   
}

function contactoBorradoCorrectamente() 
{
//mostrar notificación
 crearNotificacionBorrar('Contacto Eliminado correctamente', 'CONTACTO ELIMINADO');
  //Eliminar loader
  eliminarLoader();
  //Mostramos la Tabla
  crearTablaContactos();
}

function contactoborradoError()
{
    //mostrar notificación
  crearNotificacionError('Problemas al Eliminar', 'ERROR');
  //Eliminar loader
  eliminarLoader();
  //Mostramos la Tabla
  crearTablaContactos();

}

</script>